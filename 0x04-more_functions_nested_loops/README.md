more functions and nexted loopd
